{% extends "_layout.html" %}
{% set active_page = 'import' %}

{% import 'macros/_account_macros.html' as account_macros with context %}

{% block content %}
{% if not ledger.fava_options['import-config'] %}
<p>
No importers configured. See <a href="{{ url_for('help_page', page_slug='import') }}">Help (Import)</a> for more information.
</p>
{% endif %}
{% for directory in ledger.fava_options['import-dirs'] %}
<h3>{{ directory }}</h3>
<table class="ingest-files">
  <thead>
    <tr>
      <th>{{ _('File') }}</th>
      <th>{{ _('Importer') }}</th>
      <th>{{ _('Account') }}</th>
      <th>{{ _('Date') }}</th>
      <th>{{ _('Destination filename') }}</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for filename, importer, new_filename in ledger.ingest.identify_directory(directory) %}
    <tr>
      <td>
        <pre title="{{Â filename }}">{{ filename|basename }}</pre>
      </td>
      <td>{{ importer.name() }}</td>
      <td>{{ account_macros.account_name(ledger.ingest.file_account(filename, importer) or '') }}</td>
      <td>{{ ledger.ingest.file_date(filename, importer) or '' }}</td>
      <td>{{ new_filename or '' }}</td>
      <td>
        <a class="button" title="{{ _('Extract') }} {{ filename }}" href="{{ url_for('report', report_name='extract', filename=filename, importer=importer.name()) }}">{{ _('Extract') }}</button>
      </td>
      <td>
        <a class="button" title="{{ _('Move') }} {{ filename }}" href="{{ url_for('report', report_name='extract', filename=filename, importer=importer.name()) }}">{{ _('Move') }}</button>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endfor %}
{% endblock %}
